---
date: 2017-01-16
title: STCPRen
categories:
  - STCP ren
description: STCPRen Versão 4.0.0 
type: Document
---



## **1. Introdução** 

### 1.1 O que é o STCPRen?    

O STCPRen é uma aplicação que possibilita o renomeio e cópia de arquivos, varredura em diretórios e execução de processo, baseado na configuração de regras de validação dos nomes destes arquivos.

O STCPRen pode ser utilizado na integração do STCP OFTP Server ou STCP OFTP Client com diferentes outras aplicações (ERPs, EDI, etc...) de forma simples e direta.

No cenário apresentado abaixo, mostramos a integração da estrutura de diretórios de transferência do STCP OFTP Client com a de incorporação e geração de arquivos financeiros de um sistema de ERP.

![](/images/imagem2/imgR165.png) 

As regras de validação e das ações (renomeio, cópia, backup, etc) deverão ser armazenadas em um ou mais arquivos de configuração.

### 1.2. Características Gerais

* Renomeio de arquivo(s)  
* Cópia para múltiplos diretórios  
* Conversão de formato texto (Unix/Dos)  
* Validação do nome do arquivo por expressão regular   
* Remoção do arquivo por data do último acesso   
* Execução de processo (.BAT, .EXE, etc...)  
* Registro de log das ações realizadas  
* Geração de timestamp com data e hora do computador ou do arquivo  
* Mapeamento dinâmico de recursos de rede  
* Varredura de diretório e subdiretório  
* Validação de diretório por expressão regular  
* Conversão maiúscula e minúscula do nome do arquivo  

---------
## **2. Requisitos de software e hardware**  

* Processador 500MHz x86, x64 ou superior  
* Memória de 128 Mbytes ou superior   
* Espaço no disco rígido de 5 Mbytes  
* Drive de CD-ROM  
* Sistema operacional Windows 2000/XP/2003/Vista/2008   

--------
## **3. Instalação**  

3.1. Insira o CD na unidade de leitura.  
3.2. Em **Iniciar**, escolha a opção **Executar**.   
3.3. Utilize o botão **Procurar** para acessar a unidade de leitura de CD.  
3.4. Selecione o programa **SETUP.EXE**.  
3.5. Execute o programa.  

-----------
## **4. Utilização** 

### 4.1. Modos de operação e opções de execução

O STCPRen é uma aplicação (.EXE) que pode ser executada diretamente na linha de comando do sistema operacional, através do agendador de tarefas ou por outras aplicações: STCP OFTP Server ou Client, TWS*, etc.

O STCPRen possui quatro modos de operação distintos e a seleção será realizada através da linha de comando, são eles:

Modo | Linha de Comando
:--- | :---
**Arquivo específico**| Stcpren_3_2.exe –rules < nome do arquivo de regras> <nome do arquivo específico>
**Lista de arquivos**| Stcpren_3_2.exe –rules < nome do arquivo de regras> -filelist < nome do arquivo de lista>
**Varredura de um diretório específico**| Stcpren_3_2.exe –rules < nome do arquivo de regras> -scan <nome do diretório>
**Varredura de uma lista de diretórios**|Stcpren_3_2.exe –rules <nome do arquivo de regras> -dirlist <nome do arquivo de lista>

Quando o modo de varredura é utilizado, a opção “**-subdir**” habilita a procura nos subdiretórios.

### 4.2. Formação do novo nome do diretório e do arquivo

Quando o STCPRen localiza um arquivo, separa o nome do diretório do nome do arquivo e possibilita a utilização destas informações pelas regras de substituição (Figura 2).

![](/images/imagem2/imgR166.png) 

A seleção das informações para formar um novo nome de diretório e de arquivo nas ações de “Cópia” e ou de “Backup” serão configuradas através das regras de substituição (Figura 3).

![](/images/imagem2/imgR167.png) 

![](/images/imagem2/imgR168.png) 

### 4.3. Variávies internas

O STCPRen possui um conjunto de variáveis internas que poderão ser utilizadas nas opções de configuração: ExeProgBefore, ExecProgAfter, ExecProgError, CheckLockUnlockFileName, CreateLockUnlockFileName, etc...

Variável | Descrição
:---     | :---
**$FILENEWNAME**| Novo nome do arquivo com o diretório (após as substituições).
**$FILEOLDNAME**| Nome original do arquivo com o diretório.
**$PATHNEWNAME**| Nome novo do diretório (após as substituições).
**$PATHOLDNAME**| Nome original do diretório.
**$NEWNAME**    | Nome novo do arquivo.
**$OLDNAME**    | Nome do arquivo original.
**$NEW2NAME**   | Novo nome do arquivo (após as substituições) sem a extensão.
**$OLD2NAME**   | Nome do arquivo original sem a extensão.
**$FILESIZE**   | Tamanho do arquivo em bytes.
**$TIMESTAMP**  | Timestamp no formato: YYYYMMDDhhmmssnnn /YYYY = ano /MM = mês /DD = dia /hh = hora (formato 24h) /mm = minuto /ss = segundos /nnn = milésimos de segundos
**$RULENAME**   | Nome da regra executada
**$DESCR**      | Descrição da regra
**$ERROR**      | Último código de erro
**$VAR0 até $VAR9**| Variáveis utilizadas na linha de comando –var0 até – var9.
**$SRCUSER**    | Identificação de origem
**$DSTUSER**    | Identificação de destino

### 4.4. Registro de Log dos Eventos

O STCPRen irá registrar as ações executadas em um arquivo diário de log dos eventos contendo: data e hora, nome do arquivo original, novo nome do arquivo, etc.

Os dados poderão ser armazenados em arquivo texto ou banco de dados.

![](/images/imagem2/imgR169.png) 

---------------
## **5. Configuração** 

A configuração das regras de validação do nome de arquivo e as ações executadas pelo STCPRen podem ser criadas com o auxílio do programa STCPRenCfg.EXE ou de um editor de texto, por exemplo, “NOTEPAD.EXE”.

Este capítulo demonstra como utilizar o programa STCPRenCfg.EXE paracriar ou editar o arquivo de configuração de regras.

### 5.1. Como adicionar ou criar um arquivo de configuração de regras

5.1.1. Acesse a pasta de instalação do STCPRen e execute o programa **STCPRenCfg.exe**.

5.1.2. Clique no botão “**Adicionar**” para selecionar o arquivo de configuração ou criar um novo.

![](/images/imagem2/imgR170.png) 

5.1.3. Clique no botão indicado para localizar o arquivo. 

![](/images/imagem2/imgR171.png) 

5.1.4. Para criar um novo arquivo, digite um novo nome e clique no botão “**Abrir**”. 

![](/images/imagem2/imgR172.png) 

5.1.5. Clique no botão “OK” para adicionar ou criar o arquivo de configuração de regras.

![](/images/imagem2/imgR173.png) 

5.1.6. Caso o arquivo de configuração não exista, uma janela de aviso será apresentada, clique no botão “**Sim**” para confirmar.

![](/images/imagem2/imgR174.png) 

### 5.2. Como alterar os parâmetros de configuração do arquivo de regras

5.2.1. Selecione o arquivo de configuração desejado e clique no botão “**Propriedades**”.

![](/images/imagem2/imgR175.png) 

5.2.2. Na guia “**Geral**”, configure os parâmetros desejados.

![](/images/imagem2/imgR176.png) 

Parâmetro| Descrição
:---     | :---
**ScanDir**  | Define o nome do diretório para varredura. /Obs.: Este parâmetro será utilizado somente se a opção –scan for definida na linha de comando do STCPRen.
**ScanDirRegEx**| Define uma expressão regular para validar os subdiretórios que serão processados na varredura.
**ScanDirRegExNeg**| Define uma expressão regular para validar os diretórios que não serão excluídos da varredura.
**ScanLockSem**| Define um nome de semáfora para sincronização do modo de varredura. /Obs.: Utilizado para sincronizar a execução de múltiplos processos do STCPREN. Válido somente com o uso da opção -scan.
**ScanLockSemTimeout**| Intervalo entre as execuções das instâncias do STCPRen.
**ScanLockSemOptions**| Executa uma instância por vez.
**ScanFirstRule**     | Define a primeira regra de validação do nome do arquivo a ser executada.
**ScanSubDir**        | Define se os subdiretórios serão verificados./ 0 = Não /1 = Sim
**ScanCheckFileInUse**| Habilita/desabilita a verificação se o arquivo está em uso. /0 = Não /1 = Sim
**MaxRetries**        | Define o número de tentativas a serem realizadas antes de abandonar a operação (cópia, criação de diretório e apagar).
**DelayRetry**        | Define o tempo de espera (em milisegundos) antes de realizar uma nova tentativa de operação (cópia, criação de diretório e apagar).
**LogErrorOption**    | Define a opção de registro dos eventos de falha na localização de um diretório ou arquivo. /0 = Não registra /1 = Registra se o arquivo não existir /2 = Registra se o diretório não existir /3 = Registra se arquivo ou diretório não existirem

5.2.3. Na guia “**Acesso**”, é possível configurar os parâmetros para utilização de um compartilhamento de rede.

![](/images/imagem2/imgR177.png) 

Parâmetro     | Descrição 
:---          | :---
**LocalName** | Define o nome do recurso local (não é obrigatório).
**RemoteName**| Define o nome do recurso de rede para ter acesso.
**UserName**  | Define o nome do usuário para acesso ao recurso.
**UserPswd**  | Define a senha do usuário para acesso ao recurso.
**Confirmar** | Confirma a senha digitada anteriormente.

5.2.4. Na guia “**Log**”, é possível configurar os parâmetros para gravação dos registros de eventos de execução do STCPRen.

![](/images/imagem2/imgR178.png) 

Parâmetro | Descrição
:---      | :---
**LogIni**| Define o nome do arquivo contendo as diretivas de log.
**LogLevelOnSucess**| Define o nível de log dos eventos de sucesso da aplicação.
**LogLevelOnInfo**  | Define o nível de log dos eventos de informação da aplicação.
**LogLevelOnWarning**| Define o nível de log dos eventos de alerta da aplicação.
**LogLevelOnError**| Define o nível de log dos eventos de erro da aplicação.
**MessageFile** | Define o diretório para criação do arquivo de mensagem geral.
**MessageFileUser**| Define o diretório para criação do arquivo de mensagem do usuário. 
**Verbose** | Define o nível de informação a ser armazenada.
**UserLog**| Define se as mensagens serão geradas por usuário: /0 = Log geral /1 = Log por usuário

5.2.5. Na guia “**Variáveis**”, você pode definir regras de substituição dos valores informados nas variáveis (–var0 à –var9) utilizados na linha de comando do STCPRen.

![](/images/imagem2/imgR179.png) 

5.2.6. Clique no botão “**Adicionar**” para configurar uma nova **regra de substituição dos valores de uma variável**.

![](/images/imagem2/imgR180.png) 

5.2.7. Configure os parâmetros da regra de substituição e clique no botão “*OK**” para salvar.

![](/images/imagem2/imgR181.png) 

Parâmetro | Descrição
:---      | :---
**$Var**  | Define a identificação da variável que será utilizada. /Valor: 0 a 9.
**Ocorrência**| Define a sequência de execução da substituição. /Valor: 0 a 999
**Descrição**| Define o nome da regra de substituição.
**RegExReplaceFrom**| Define a expressão regular para selecionar o que será substituído.
**RegExReplaceTo**| Define o valor para substituição.
**RegExReplaceOcorr**| Define a quantidade de repetições da substituição: /0 = Todas

5.2.8. Na guia “**Listas**”, você pode substituir as linhas do arquivo pelos valores das variáveis (-var0 à -var9) ou através de uma expressão regular criando regras de substituição.

O arquivo de lista pode conter nomes de diretórios ou arquivos que serão processados. As regras de substituição serão aplicadas às linhas do arquivo.

![](/images/imagem2/imgR182.png) 

5.2.9. Clique no botão “**Adicionar**” para configurar uma nova **regra desubstituição através de uma variável**. 

![](/images/imagem2/imgR183.png) 

5.2.10. Configure os parâmetros da regra de substituição e clique no botão “**OK**” para salvar.

![](/images/imagem2/imgR184.png) 

Parâmetro | Descrição
:---      | :---
**Ocorrência**| Define a sequência de execução da substituição. /Valor: 0 a 999
**Descrição** | Define o nome da regra de substituição.
**VarReplaceFileNamePosFrom**| Modifica o novo nome do arquivo com parte do valor da variável (var0,var1, ..., varn) a partir da posição de origem definida.
**VarReplaceFileNamePosTo**  | Modifica o novo nome do arquivo com parte do valor da variável (var0,var1, ..., varn) para a posição de destino definida.
**VarReplaceFileNameLen**    | Modifica o novo nome do arquivo com parte do valor da variável (var0,var1, ..., varn) com o tamanho definido.
**VarReplaceFileNameValue**  | Define o valor da variável quando não for informado na linha de comando (-varn).

5.2.11. Clique no botão “**Adicionar**” para configurar uma nova **regra de substituição através de uma expressão regular**. 

![](/images/imagem2/imgR185.png) 

5.2.12. Configure os parâmetros da regra de substituição e clique no botão “**OK**” para salvar.

![](/images/imagem2/imgR186.png) 

Parâmetro     | Descrição
:---          | :---
**Ocorrência**| Define a sequência de execução da substituição. /Valor: 0 a 999
**Descrição** | Define o nome da regra de substituição.
**RegExReplaceFrom**| Define a expressão regular para selecionar os dados que serão substituídos.
**RegExReplaceTo**  | Define o valor para substituição.
**RegExReplaceOcorr**| Define a quantidade de repetições da substituição: /0 = Todas

### 5.3. Como criar e modificar as Regras de Validação dos nomes de arquivos

5.3.1. Na guia “**Regras de Validação**”, clique no botão “**Adicionar**” para criar uma nova regra ou selecione uma regra e clique no botão “**Propriedades**” para modificá-la.

![](/images/imagem2/imgR187.png) 

5.3.2. Clique no botão “**Adicionar**” para criar uma nova regra. 

![](/images/imagem2/imgR188.png) 

5.3.3. Configure a identificação da regra e clique no botão “OK” para salvar. 

![](/images/imagem2/imgR189.png) 

Parâmetro| Descrição
:---     | :---
**Regra**| Define o número da regra (ordem de execução).
**Nome** | Define o nome da regra. 

5.3.4. Selecione uma regra e clique no botão “**Ordenar regras**”. 

![](/images/imagem2/imgR190.png) 

5.3.5. Nesta tela, selecione o intervalo de ordenação das regras: 

![](/images/imagem2/imgR191.png)

5.3.7. Selecione uma regra e clique no botão “**Propriedades**” para modificar os seus parâmetros.

![](/images/imagem2/imgR192.png) 

Para mudar o número da regra (ordem de execução), selecione-a e pressione os botão ![](/images/imagem2/imgR193.png) ou ![](/images/imagem2/imgR194.png). 

5.3.8. Na guia “**Geral**”, configure os parâmetros de identificação da regra, validação do arquivo e outros:

![](/images/imagem2/imgR195.png) 

Parâmetro | Descrição
:---      | :---
**Regra** | Define o número da regra (ordem de execução).
**Nome**  | Define o nome da regra.
**DirRegEx**| Define a expressão regular para validar o nome do diretório. 
**FileRegEx**| Define a expressão regular para validar o nome do arquivo.
**SrcRegEx**| Define a expressão regular para validar o nome do usuário de origem (opção –src da linha de comando).
**ContentRegEx**| Habilita a validação do arquivo através de seu conteúdo.
**Description**| Define a descrição da regra.
**ExecProgBefore**| Define o nome do programa ou batch que deve ser executado antes de processar o arquivo.
**ExecProgAfter**| Define o nome do programa ou batch que deve ser executado após processar o arquivo.
**ExecProgError**| Define o nome do programa ou batch que deve ser executado quando ocorrer um erro.
**DestinationUser**| Nome do usuário/módulo de destino do STCP OFTP (opcional).
**SourceUser**| Nome do usuário/módulo de origem do STCP OFTP (opcional).
**NextSection**| Define a próxima seção de processamento a ser executada para esta regra. O nome do arquivo para processamento é o mesmo do início da regra.
**RemoveAfterCopy**| Ativa ou inibe a remoção do arquivo: /Não = Não remove o arquivo /Sim = Remove o arquivo
**RemoveAfterHours**| Remove o arquivo somente se o último acesso tiver ocorrido antes da quantidade de horas estabelecida neste parâmetro:/0 = Remove imediatamente />0 = Remove após a quantidade de horas especificada. 
**Overwrite**| Ativa ou inibe a sobreposição do arquivo: /Não = Não sobrepõe /Sim = Sobrepõe /Obs: Veja a opção de CopyFileOption e BackupFileOption para habilitar a sobreposição em cada operação individualmente.
**ProcessAfterSeconds**| Processa o arquivo somente se o último acesso tiver ocorrido após a quantidade de segundos estabelecida neste parâmetro.

5.3.9. Na guia “**Renomeio de Arquivo I**”, configure os parâmetros que serão utilizados na definição do “**Novo Nome do Arquivo**”.

![](/images/imagem2/imgR196.png) 

Parâmetro | Descrição
:---      | :---
**RenameFileTo**| Define o novo nome para o arquivo. /Obs.: Se este parâmetro não for definido, o nome original será utilizado.
**InsertTimestamp**| Define a utilização do timestamp na nova nomenclatura: /0 = Não insere /1 = Insere no final do nome do arquivo /2 = Insere no início do nome do arquivo 4 = Insere customizado (através das opções de substituição) ![](/images/imagem2/imgR197.png) 
**InsertTimestampPart**| Define o tipo de timestamp a ser utilizado pela opção InsertTimestamp: /0 = Data e hora do sistema (computador local) /1 = Data e hora da criação do arquivo /2 = Data e hora da última modificação do arquivo /4 = Data e hora do último acesso ao arquivo ![](/images/imagem2/imgR198.png)

5.3.10. Na guia “**Renomeio de Arquivo I**”, clique em “**Adicionar**” e configure as regras de renomeio do “**Novo Nome do Arquivo**” com as opções de “Substituição através do nome original”.

![](/images/imagem2/imgR199.png) 

5.3.11. Configure as opções de substituição através do nome original do arquivo e do diretório, variáveis, número de sequência, timestamp e clique no botão “**OK**” para salvar.

![](/images/imagem2/imgR200.png)

Parâmetro | Descrição
:---      | :---
**Ocorrência**| Define a sequência de execução da substituição. Valor: 0 a 999
**Descrição**| Define a identificação da regra de renomeio.
**ReplaceFileNamePosFrom**| Modifica o novo nome do arquivo com parte do nome antigo a partir da posição de origem definida.
**ReplaceFileNamePosTo**| Modifica o novo nome do arquivo com parte do nome antigo para a posição de destino definida.
**ReplaceFileNameLen**| Modifica o novo nome do arquivo com parte do nome antigo com o tamanho definido. 
**ReplaceFileNameFromPathPosFrom**| Modifica o novo nome do arquivo com parte do path do arquivo original a partir da posição de origem definida.
**ReplaceFileNameFromPathPosTo**| Modifica o novo nome do arquivo com parte do path do arquivo original para a posição de destino definida.
**ReplaceFileNameFromPathLen**| Modifica o nome do arquivo com parte do path do arquivo original com o tamanho definido.
**VarReplaceFileNamePosFrom**| Modifica o novo nome do arquivo com parte do valor da variável (var0,var1, ..., varn) a partir da posição de origem definida.
**VarReplaceFileNamePosTo**| Modifica o novo nome do arquivo com parte do valor da variável (var0,var1, ..., varn) para a posição de destino definida.
**VarReplaceFileNameLen**| Modifica o novo nome do arquivo com parte do valor da variável (var0,var1, ..., varn) com o tamanho definido.
**VarReplaceFileNameValue**| Define o valor da variável quando não for informado na linha de comando (-varn).
**InsertSeqNumberTo**| Insere um número de sequência no novo nome a partir da posição de destino definida.
**InsertSeqNumberLen**| Insere um número de sequência no novo nome com o tamanho definido.
**InsertSeqNumberMIn**| Número de sequência inicial.
**InsertSeqNumberMax**| Número de sequência final.
**InsertSeqNumberSeq**| Número de sequência atual.
**InsertTimestampPosFrom**| Modifica o novo nome com parte do Timestamp a partir da posição de origem definida.
**InsertTimestampPosTo**| Modifica o novo nome com parte do Timestamp para a posição de destino definida.
**InsertTimestampLen**| Modifica o novo nome com parte do Timestamp com o tamanho.

5.3.12. Na guia “**Renomeio de Arquivo II**”, configure as regras de renomeiodo “**Novo Nome do Arquivo**” através do conteúdo do arquivo original ou de uma expressão regular:

![](/images/imagem2/imgR201.png) 

Parâmetro | Descrição
:---      | :---
**ReplaceFromFileOption**| Habilita/Desabilita a utilização do conteúdo do arquivo original para fazer o renomeio.

5.3.13. Clique em “**Adicionar**” para configurar as regras de “**Substituição através do conteúdo do arquivo original**” que serão aplicadas no “**Novo Nome do Arquivo**”:

![](/images/imagem2/imgR202.png)

5.3.14. Configure os parâmetros de substituição e clique no botão “**OK**” para salvar.

![](/images/imagem2/imgR203.png) 

Parâmetro | Descrição
:---      | :---
**Ocorrência**| Define a sequência de execução. /Valor: 0 a 999
**Descrição**| Define a identificação da regra.
**ReplaceFromFileRegEx**| Define uma expressão regular para validar a linha que contém a informação que deverá ser utilizada na substituição.
**ReplaceFromFilePosFrom**| Define a coluna inicial da linha selecionada.
**ReplaceFromFilePosTo**| Define a posição inicial do novo nome para onde serão copiados.
**RepalceFromFileLen**| Quantidade de caracteres que serão copiados a partir da coluna inicial.

5.3.15. Clique em “**Adicionar**” para configurar as regras de “**Substituição através de uma expressão regular**” que serão aplicadas no “**Novo Nome do Arquivo**”:

![](/images/imagem2/imgR204.png) 

5.3.16. Configure os parâmetros de substituição e clique no botão “**OK**” para salvar.

![](/images/imagem2/imgR205.png) 

Parâmetro | Descrição
:---      | :---
**Ocorrência**| Define a sequência de execução. /Valor: 0 a 999
**Descrição**| Define a identificação da regra.
**RegExReplaceFrom**| Define uma expressão regular para selecionar os dados que deverão ser .
**RegExReplaceTo**| Define o valor para substituição.
**RegExReplaceOcorr**| Define a quantidade de repetições da substituição: /0 = Todas

5.3.17. Na guia “**Cópia**”, configure os parâmetros que serão utilizados na definição do “**Novo Nome do Diretório**” para onde será copiado o arquivo original.

![](/images/imagem2/imgR206.png) 

Parâmetro| Descrição
:---     | :---
**CopyToDir**| Define o nome do diretório de destino para onde deverá ser copiado o arquivo.
**CopyFileOption**| Define as opções de cópia que deverão ser utilizadas. ![](/images/imagem2/imgR207.png) 
**CopyTempExtension**| Define uma extensão temporária para o arquivo enquanto o processo de cópia não é finalizado.

5.3.18. Clique em “**Adicionar**” para configurar as regras de “**Substituição
através do nome original**” que serão aplicadas no “**Novo Nome do Diretório**”.

![](/images/imagem2/imgR208.png) 

5.3.19. Configure os parâmetros de substituição e clique no botão “**OK**” para salvar.

![](/images/imagem2/imgR209.png) 

Parâmetro | Descrição
:---      | :---
**Ocorrência**| Define a sequência de execução. /Valor: 0 a 999
**Descrição**| Define a identificação da regra.
**CopyPathReplacePosFrom**| Modifica o nome do path da cópia com parte do path original a partir da posição de origem definida.
**CopyPathReplacePosTo**| Modifica o nome do path da cópia com parte do path original para a posição de destino definida.
**CopyPathReplaceLen**| Modifica o nome do path da cópia com parte do path original com o tamanho definido.
**CopyPathVarReplacePosFrom**| Modifica o nome do path da cópia com parte da variável a partir da posição de origem definida.
**CopyPathVarReplacePosTo**| Modifica o nome do path da cópia com parte da variável para a posição de destino definida.
**CopyPathVarReplaceLen**| Modifica o nome do path da cópia com parte da variável com o tamanho definido. 
**CopyPathVarReplaceValue**| Define o valor variável.
**CopyPathReplaceFFNPosFrom**| Modifica o nome do path da cópia com parte do nome original do arquivo (FFN) a partir da posição de origem definida.
**CopyPathReplaceFFNPosTo**| Modifica o nome do path da cópia com parte do nome original do arquivo (FFN) para a posição de destino definida.
**CopyPathReplaceFFNLen**| Modifica o nome do path da cópia com parte do nome original do arquivo (FFN) com o tamanho definido.
**CopyPathInsertTMPPosFrom**| Modifica o nome do path da cópia com o timestamp (TMP) a partir da posição de origem definida.
**CopyPathInsertTMPPosTo**| Modifica o nome do path da cópia com o timestamp (TMP) a partir da posição de origem definida.
**CopyPathInsertTMPLen**| Modifica o nome do path da cópia com o timestamp (TMP) considerando o tamanho definido.

5.3.20. Clique em “**Adicionar**” para configurar as regras de “**Substituição através de expressão regular**” que serão aplicadas no “**Novo Nome do Diretório**”. 

![](/images/imagem2/imgR210.png) 

5.3.21. Configure os parâmetros de substituição e clique no botão “**OK**” para salvar.

![](/images/imagem2/imgR211.png) 

Parâmetro| Descrição
:---     | :---
**Ocorrência**| Define a sequência de execução. /Valor: 0 a 999
**Descrição**| Define a identificação da regra.
**CopyPathRegExReplaceFrom**| Define uma expressão regular para selecionar os dados que deverão ser .
**CopyPathRegExReplaceTo**| Define o valor para substituição.
**CopyPathRegExReplaceOcorr**| Define a quantidade de repetições da substituição: /0 = Todas

5.3.22. Na guia “**Backup**”, configure os parâmetros que serão utilizados na definição do “**Novo Nome do Diretório**”, para onde será copiado o arquivo original:

![](/images/imagem2/imgR212.png) 

Parâmetro| Descrição
:---     | :---
**BkpToDir**| Define o nome do diretório destino para onde deverá ser copiado o arquivo de backup.
**BkpFileOption**| Define as opções de backup que deverão ser utilizadas.![](/images/imagem2/imgR213.png) 

5.3.23. Clique em “**Adicionar**” para configurar as regras de “**Substituição
através do nome original**” que serão aplicadas no “**Novo Nome do Diretório**” de backup.

![](/images/imagem2/imgR214.png) 

5.3.24. Configure os parâmetros de substituição e clique no botão “**OK**” para salvar.

![](/images/imagem2/imgR215.png) 

Parâmetro| Descrição
:---     | :----
**Ocorrência**| Define a sequência de eventos.
**Descrição**| Identifica a regra de Backup.
**BkpPathReplacePosFrom**| Modifica o nome do path de bachup com parte do path original a partir da posição de origem definida.
**BkpPathReplacePosTo**| Modifica o nome do path de backup com parte do path original para a posição de destino definida.
**BkpPathReplaceLen**| Modifica o nome do path de backup com parte do path original com o tamanho definido.
**BkpPathReplaceVarReplacePosFrom**| Modifica o nome do path de backup com parte da variável a partir da posição de origem definida.
**BkpPathVarReplacePosTo**| Modifica o nome do path de backup com parte da variável para a posição de destino definida.
**BkpPathVarReplaceLen**| Modifica o nome do path de backup com parte da variável com o tamanho definido.
**BkpPathVarReplaceValue**|  Define o valor variável. 
**BkpPathReplaceFFNPosFrom**| Modifica o nome do path de backup com parte do nome original do arquivo (FFN) a partir da posição de origem definida.
**BkpPathFFNPosTo**| Modifica o nome do path de backup com parte do nome original do arquivo (FFN) para a posição de destino definida.
**BkpPathReplaceFFNLen**| Modifica o nome do path de backup com parte do nome original do arquivo (FFN) com o tamanho definido.
**BkpPathInsertTMPPosFrom**| Modifica o nome do path de backup com o timestamp(TMP) a partir da posição de origem definida.
**BkpPathInsertTMPPosTo**| Modifica o nome do path de backup com o timestamp (TMP) a partir da posição de origem definida.
**BkpPathInsertTMPLen**| Modifica o nome do path da cópia com o timestamp (TMP) considerando o tamanho definido.

5.3.25. Clique em “**Adicionar**” para configurar as regras de “**Substituição
através de expressão regular**” que serão aplicadas no “**Novo Nome do Diretório**” de
backup.

![](/images/imagem2/imgR216.png) 

5.3.26. Configure os parâmetros de substituição e clique no botão “**OK**” para salvar.

![](/images/imagem2/imgR217.png) 

Parâmetro| Descrição
:---     | :---
**Ocorrência**| Define a sequência de execução. /Valor: 0 a 999
**Descrição**| Define a identificação da regra.
**BkpPathRegExReplaceFrom**| Define uma expressão regular para selecionar os dados que deverão ser .
**BkpPathRegExReplaceTo**| Define o valor para substituição.
**BkpPathRegExReplaceOcorr**| Define a quantidade de repetições da substituição: /0 = Todas

5.3.27. Na guia “**Avançadas**”, configure os parâmetros:

![](/images/imagem2/imgR218.png) 

Parâmetro| Descrição
:---     | :---
**CheckLockUnlockOption**| Define as opções de criação/utilização do arquivo de sincronização de acesso ao arquivo que está sendo processado. ![](/images/imagem2/imgR219.png) 
**CheckLockUnlockFileName**| Define o nome do arquivo de bloqueio/desbloqueio que deverá ser verificado.
**CreateLockUnlockFileName**| Define o nome do arquivo de bloqueio/desbloqueio que deverá ser criado.
**Controle de tamanho de arquivos**| Define o tamanho mínimo e máximo que o arquivo pode ter para ser processado pela regra.
**Período de execução**| Define o período (Início, Fim e Dias da Semana) em que uma regra deverá ser executada.
**DelayNextFileProcess**| Define o intervalo mínimo (em milisegundos) para processar o próximo arquivo na mesma regra.
**ContentLinesToRead**| Se o parâmetro ContentRegEx estiver setado esta opção valida o número de linhas que serão lidas do arquivo.
**ResetSeqNumberDaily**| Zera diariamente o número de sequência informado no parâmetro “InsertSeqNumberSeq” (Renomeio de Arquivo I).

--------
## **6. Execução**  

### 6.1 Linha de comando 

**Linha de Comando**   
stcpren_3_2.exe [opções]

[Opções] | Descrição
:---     | :---
**-log < arquivo de log>**| Define o nome do arquivo de configuração de log.
**-rules < arquivo de regras>**| Define o nome do arquivo de regras.
**-firstrule <número da regra>**| Define a primeira regra a ser processada.
**-scan < nome do diretório>**| Define o nome do diretório para varredura.
**-subdir**| Habilita a procura do subdiretório.
**-dirregex < regex>**| Define uma expressão regular para validar os subdiretórios que serão processados.
**-dirregexneg < regex>**| Define uma expressão regular para validar os subdiretórios que não serão processados.
**-fileregex < regex>**| Define uma expressão regular para validar os nomes de arquivos que serão processados.
**-fileregexneg < regex>**| Define uma expressão regular para validar os nomes de arquivos que não serão processados.
**-filelist < nome da lista>**| Define o nome do arquivo da lista de arquivos.
**-dirlist < nome da lista>**| Define o nome do arquivo de lista de diretórios.
**-scansemname < nome>**| Define um nome de semáfora para sincronização do modo de varredura. /Obs.: Utilizado para sincronizar a execução de múltiplos processos do STCPREN.
**-var(N) < valor>**| Define o valor da variável.
O índice (N) pode variar de 0 a 9.

----------
## **7. Códigos de Eventos**  

### 7.1 Códigos de eventos gerados no arquivo de mensagens 

Mensagem   | Descrição
:---       | :---
**MSG7001**| [MSG7001] LOCAL - <STCPREN> - Erro: quantidade de parametros e insuficiente - '%d'
**MSG7002**| [MSG7002] LOCAL - <STCPREN> - Erro: nome do arquivo invalido - '%s'
**MSG7003**| [MSG7003] LOCAL - <STCPREN> - Erro: arquivo de regras '%s' nao tem definicao para arquivo '%s'
**MSG7004**| [MSG7004] LOCAL - <STCPREN> - Erro: servico de log nao foi aberto
**MSG7005**| [MSG7005] LOCAL - %s - Erro: regra '%s' com parametro invalido no arquivo '%s'
**MSG7006**| [MSG7006] LOCAL - %s - Inicio do STCPREN para o arquivo '%s'
**MSG7007**| [MSG7007] LOCAL - %s - Erro: copia do arquivo de '%s' para '%s' [codigo:%u]
**MSG7008**| [MSG7008] LOCAL - %s - Copia do arquivo de '%s' para '%s' destino '%s'
**MSG7009**| [MSG7009] LOCAL - %s - Copia do arquivo de '%s' para '%s' origem '%s’
**MSG7010**| [MSG7010] LOCAL - %s - Erro: remover o arquivo '%s' [codigo:%u]
**MSG7011**| [MSG7011] LOCAL - %s - Erro: executar o comando '%s %s'[codigo:%u]
**MSG7012**| [MSG7012] LOCAL - %s - Erro: executar o comando '%s %s'[codigo:%u]
**MSG7013**| [MSG7013] LOCAL - <STCPREN> - Erro: conectar recurso '%s' [codigo:%u]
**MSG7014**| [MSG7014] LOCAL - <STCPREN> - Erro: desconectar recurso '%s' [codigo:%u]

-------------
## **8. Glossário** 

**E** 

**Endereço IP**  
Este endereço é um número único para cada computador conectado a Internet, composto por uma sequência de 4 números que variam de 0 até 255, separados por “.”. 

**F** 
_**Firewall**_  
Dispositivo constituído pela combinação de software e hardware, utilizado para dividir e controlar o acesso entre redes de computadores.

**H** 

**HTTP**   
Do Inglês _**H**yper**T**ext **T**ransfer **P**rotocol_. Protocolo usado para transferir páginas _Web_ entre um servidor e um cliente, por exemplo, o _browser_.

**I**  

**ISDN**  
O ISDN (Integrated Services Digital Network) é um sistema de conexões de telefone digital. 

**L** 
_**Log**_  
Registro de atividades por programas de computador. No caso de logs relativos a incidentes de segurança, eles normalmente são gerados por _firewalls_ ou por IDSs.

**M**  

**Macro**   
É sinônimo para um grupo de instruções que pode ser usado como uma instrução ao longo do código-fonte.

**P**   

**Protocolo OFTP (ODETTE File Transfer Protocol)**    
O OFTP foi primeiramente especificado com premissas do modelo interconexão de sistemas abertos (OSI) utilizando o serviço de rede recomendado pela norma CCITT X.25.  
Com o crescimento da utilização do OFTP por diferentes setores, a organização ODETTE ampliou o escopo de padronização e incorporou a utilização do protocolo TCP/IP.

**PPP**   
O PPP (Point-to-Point Protocol) é o método mais usado para transportar pacotes do IP sobre uma ligação de série entre o usuário e a Internet Service Provider (ISP).

**R**

**RAS**   
Um protocolo para configuração de uma VPN.

**S**

**Scan**    
Técnica normalmente implementada por um tipo de programa, projetado para efetuar varreduras em redes de computadores.

**SMM**
System Management Module (Módulo de Gerenciamento de Sistema).

**SSL**
Do Inglês _**S**ecure **S**ockets **L**ayer_. Protocolo que fornece confidencialidade e integridade na comunicação entre um cliente e um servidor, através do uso de criptografia.

**U**

**UNC**    
Este é um formato de nome de arquivo que é usado para especificar a localização dos arquivos, pastas e recursos na rede local (LAN).

**V**

**VPN**    
É uma rede de comunicação privada normalmente utilizada por uma empresa ou um conjunto de empresas e/ou instituições, construída em cima de uma rede de comunicação pública, por exemplo, a Internet.

-----------
## **9. Referências**  

Disponível em: (<http://www.tech-faq.com/lang/pt/ppp.shtml>). Acesso em: 20 de julho de 2007.

Disponível em: (<http://cartilha.cert.br/glossario/>). Acesso em: 20 de julho de 2007.

Disponível em: (<http://www.iwebtool.com/what_is_unc.html>). Acesso em: 20 de julho de 2007.
