---
date: 2017-01-16
title: Procedimento Monitor
categories:
  - Monitor
description:  Procedimento para instalação e configurações iniciais do STCP MONITOR (LINUX)
type: Document
---

# Procedimento para instalação e configurações iniciais do STCP MONITOR (LINUX)

## **1. Objetivo**

Este documento tem como objetivo descrever os passos necessários para realizar a instalação e as configurações iniciais do STCP Monitor. Outras configurações podem ser realizadas na ferramenta conforme necessidades específicas do ambiente e/ou funcionalidades a serem utilizadas.

Todo o procedimento foi baseado na distribuição Linux CentOS 7.0 e Apache 2.4.6.

----
## **2. Requisitos Software**

* Servidor Web (Ex. Apache)       
* Suporte ao PHP 5.x ou superior¹    
* Banco de dados (SQL Server, MySQL, MariaDB ou Oracle)   
* Acesso à base de dados do STCP OFTP Server e STCP OFTP Web Admin   
* Cron Task   

![](/images/imagem1/imgM69.png) 

----
## **3. Banco de Dados**

Com o acesso liberado ao servidor de banco de dados e as suas ferramentas de gerenciamento, a base de dados “STCPMONITOR_DB” e suas respectivas tabelas deverão ser criadas utilizando os scripts disponíveis no link abaixo:

(http://www.riversoft.com.br/produtos/pub/ScriptSTCPMonitor_ALL.zip) 

SERVIDOR DE BANCO DE DADOS | STCPMONITOR_DB
:---                       | :---
Microsoft SQL Server 2005/2008/2008R2/2012/2014 |STCPMonitor_rev_6_0_0_MySQL.SQL
Oracle 9i/10g/11g/12c | STCPMonitor_rev_6_0_0_Oracle.SQL
MySQL Database 4.1/5.0/5.1/5.4/5.5/5.6 | STCPMonitor_rev_6_0_0_ SQLServer.SQL
MariaDB 5.1/5.2/5.3/5.5/10.0/10.1 | STCPMonitor_rev_6_0_0_MySQL.SQL

-----
¹ Necessária a instalação de módulos adicionais conforme banco de dados e recursos utilizados. 

----
## **4. Instalação STCP MONITOR**

O STCP Monitor é distribuído através de um link para download, enviado pela equipe de suporte da Riversoft, e os seguintes passos devem ser executados para concluir o processo de instalação:
 
![](/images/imagem1/imgM70.png) 

----
## **5. Instalação SMARTY (Templates Framewok for PHP)**

A instalação do Smarty poderá ser realizada através do gerenciador de pacotes da sua distribuição Linux ou download dos pacotes disponíveis no site (http://www.smarty.net/download)

Para mais detalhes consulte (http://www.smarty.net/quick_install)

**Exemplo de uso – Yum:** 

![](/images/imagem1/imgM71.png) 

**Exemplo de uso – Download:**

![](/images/imagem1/imgM72.png) 

----
## **6. Configuração PHP**

Com o suporte disponível no servidor, os seguintes parâmetros devem ser alterados nas configurações do PHP.

**/etc/php.d/stcp.ini** 

![](/images/imagem1/imgM73.png) 

----
## **7. Configuração Virtual-HOST**

É prática comum a criação de um arquivo de configuração “.conf” específico para o site do STCP Monitor. Os parâmetros básicos a serem configurados nesse arquivo são:

**/etc/httpd/conf.d/stcpmonitor.conf** 

![](/images/imagem1/imgM74.png) 

----
## **8. Configuração STCP MONITOR**

As configurações relacionadas ao STCP Monitor são realizadas nos arquivos “stcpwebsupallconf.inc” e “stcpwebsupbdconf.inc”, disponíveis no diretório “support/configs/” do site.

### 8.1. Arquivo STCPWEBSUPALLCONF.INC

Os parâmetros básicos a serem configurados nesse arquivo são:

> NOTA: O arquivo “stcpwebsupallconf.example.inc” deverá ser renomeado para “stcpwebsupallconf.inc”.

![](/images/imagem1/imgM75.png) 

PARÂMETROS | DESCRIÇÃO
:---       | :---
STCPWEB_CONF_LANG_DEFAULT | Define idioma padrão para a interface.
STCPWEB_CONF_REFRESH_WINDOW | Define o tempo de _auto-refresh_ utilizado na janela de monitoração.
STCPWEB_CONF_SMARTY_PATH | Define o caminho do diretório de instalação do Smarty
STCPWEB_CONF_USER_ROOT| Define usuário administrador padrão 

### 8.2. Arquivo STCPWEBSUPBDCONF.INC

Os parâmetros básicos a serem configurados nesse arquivo são:

> NOTA: O arquivo “stcpwebsupdbconf.example.inc” deverá ser renomeado para “stcpwebsupdbconf.inc”.

![](/images/imagem1/imgM76.png) 

Os parâmetros da variável **$arDatabaseAdmin** definem as configurações de acesso ao banco de dados, utilizado pelo STCP OFTP Web Admin, que gerenciará as informações de operadores, grupos e servidores.

PARÂMETROS | DESCRIÇÃO
:---       | :---
BD_METHOD  | Define o método de conexão ao gerenciador de banco de dados. As opções disponíveis são: **ODBC** e **MYSQLi**.
BD_TYPE    | Define gerenciador do banco de dados utilizado. As opções disponíveis são: **SQLSERVER**, **ORACLE** e **MYSQL**.
BD_DATE_FUNC | Define a função de data utilizada conforme o tipo de banco de dados selecionado. As opções disponíveis são: /SQLSERVER **GETDATE()** /ORACLE **SYSDATE** /MYSQL **NOW()**
BD_SERVER   | Define o endereço para acesso ao gerenciador de banco de dados.
BD_NAME     | Define o nome do banco de dados ou fonte de dados (ODBC) utilizada.
BD_USER     | Define nome do usuário para autenticação na base de dados.
BD_PSWD     | Define senha do usuário para autenticação na base de dados.
BD_CURSOR   | Define o tipo de cursor utilizado pelo gerenciador de banco de dados. Valor padrão é 0.

![](/images/imagem1/imgM77.png) 

Os parâmetros da variável **$arDatabaseProcesso** definem as configurações de acesso ao banco de dados que gerenciará os processos de monitoração (STCPMONITOR_DB).

PARÂMETROS | DESCRIÇÃO
:---       | :---
BD_METHOD  | Define o método de conexão ao gerenciador de banco de dados. As opções disponíveis são: **ODBC** e **MYSQLi**.
BD_TYPE    | Define gerenciador do banco de dados utilizado. As opções disponíveis são: **SQLSERVER, ORACLE** e **MYSQL**.
BD_DATE_FUNC | Define a função de data utilizada conforme o tipo de banco de dados selecionado. As opções disponíveis são: /SQLSERVER **GETDATE()** /ORACLE **SYSDATE** /MYSQL **NOW()**
BD_SERVER | Define o endereço para acesso ao gerenciador de banco de dados.
BD_NAME   | Define o nome do banco de dados ou fonte de dados (ODBC) utilizada.
BD_USER   | Define nome do usuário para autenticação na base de dados.
BD_PSWD   | Define senha do usuário para autenticação na base de dados.
BD_CURSOR | Define o tipo de cursor utilizado pelo gerenciador de banco de dados. Valor padrão é 0.

![](/images/imagem1/imgM78.png) 

Os parâmetros da variável **$arDatabaseRastreamento** definem as configurações de acesso ao banco de dados, utilizado pelo STCP OFTP Server para gravação de logs e eventos, onde serão coletadas as informações para rastreamento dos processos de monitoração definidos.

PARÂMETROS | DESCRIÇÃO
:---       | :---
BD_METHOD  | Define o método de conexão ao gerenciador de banco de dados. As opções disponíveis são: **ODBC** e **MYSQLi**.
BD_TYPE    | Define gerenciador do banco de dados utilizado. As opções disponíveis são: **SQLSERVER, ORACLE** e **MYSQL**.
BD_DATE_FUNC| Define a função de data utilizada conforme o tipo de banco de dados selecionado. As opções disponíveis são: /SQLSERVER **GETDATE()** /ORACLE **SYSDATE** /MYSQL **NOW()**
BD_SERVER   | Define o endereço para acesso ao gerenciador de banco de dados.
BD_NAME     | Define o nome do banco de dados ou fonte de dados (ODBC) utilizada.
BD_USER     | Define nome do usuário para autenticação na base de dados.
BD_PSWD     | Define senha do usuário para autenticação na base de dados.
BD_CURSOR   | Define o tipo de cursor utilizado pelo gerenciador de banco de dados. Valor padrão é 0.

![](/images/imagem1/imgM79.png) 

Os parâmetros da variável **$arDatabaseLogs** definem as configurações de acesso ao banco de dados, utilizado pelo STCP OFTP Web Admin para gravação de logs e eventos (TBLLOGS).

PARÂMETROS | DESCRIÇÃO
:---       | :---
BD_METHOD  | Define o método de conexão ao gerenciador de banco de dados. As opções disponíveis são: **ODBC** e **MYSQLi**.
BD_TYPE    | Define gerenciador do banco de dados utilizado. As opções disponíveis são: **SQLSERVER, ORACLE** e **MYSQL**.
BD_DATE_FUNC| Define a função de data utilizada conforme o tipo de banco de dados selecionado. As opções disponíveis são: /SQLSERVER **GETDATE()** /ORACLE **SYSDATE** /MYSQL **NOW()**
BD_SERVER   | Define o endereço para acesso ao gerenciador de banco de dados.
BD_NAME     | Define o nome do banco de dados ou fonte de dados (ODBC) utilizada.
BD_USER     | Define nome do usuário para autenticação na base de dados.
BD_PSWD     | Define senha do usuário para autenticação na base de dados.
BD_CURSOR   | Define o tipo de cursor utilizado pelo gerenciador de banco de dados. Valor padrão é 0.

----
## **9. Configuração agente de monitoração** 

A configuração do Agente de Monitoração do STCP Monitor é realizada no arquivo “(STCPMonitorRunAgent.sh)”, disponível no diretório “support/scripts/shell/” do site, e deverá ser executado por uma tarefa agendada através do Cron Tasks.

### 9.1. Arquivo STCPMONITORRUNAGENT. SH

Os parâmetros básicos a serem configurados nesse arquivo são:

> NOTA: O arquivo “STCPMonitorRunAgent.example.sh” deverá ser renomeado para “STCPMonitorRunAgent.sh”.

![](/images/imagem1/imgM80.png)

### 9.2. Configuração CRON TASKS

Os parâmetros básicos a serem configurados são:  
**#crontab -e**

![](/images/imagem1/imgM81.png) 

PARÂMETROS | DESCRIÇÃO
:---       | :---
AGENTMONPROCCRIARINFOINCLUSAO | Inclui informações de monitoração na base de dados do STCP Monitor.
AGENTMONPROCCRIARINFOATRASO   | Inclui informações de monitoração em atraso na base de dados do STCP Monitor

----
## **10. Configuração da permissão acesso à diretórios** 

Configure os diretórios relacionados abaixo com permissão de acesso para escrita (write) para o usuário responsável por gerenciar o servidor web (Ex. apache):

DIRETÓRIO | DESCRIÇÃO
:---      | :---
./stcpmonitor/smarty/ | Diretório para gravação de arquivos temporários relacionados ao Smarty
./stcpmonitor/www/images/uploads | Diretório para gravação de imagens utilizadas pelas funções de upload do STCPMonitor
/tmp  | Diretório para gravação de informações temporárias utilizadas pelo PHP. Caso a variável “upload_tmp_dir” esteja configurada no arquivo PHP.INI, a permissão deverá ser atribuída ao diretório correspondente.

